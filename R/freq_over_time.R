#' Population frequencies over time
#'
#' This function computes the probability of having at least 1 variant  
#' in the gene list of interest (assuming independence) for a range of ClinVar files
#' 
#' @usage freq_over_time(vcf)
#' @param vcf data.frame; clinvaR-processed vcf from import_file_1000g()
#' @examples 
#' freq_over_time(import_file_1000g())
#' @export

freq_over_time <- function(vcf, dates) {
  if (missing(vcf)) {
    stop('Input VCF generated by import_file_1000g()')
  }
  if (missing(dates))
    all_dates <- get_date_list()
  freqs <- lapply(all_dates, function(date) {
    merged_vcf <- annotate_1000g(clinvar = get_clinvar(date), vcf = vcf) 
    return(1-prod(1-merged_vcf$AF_1000G))
  }) %>% unlist %>% setNames(all_dates)
  plot(all_dates, freqs, type = 'o', xlab = "Dates", ylab = "Frequency", main = "Aggregate Population Frequency")
  return(freqs)
}


